<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="github.css">
</head>
<body>
<h2 id="discovery">DISCOVERY</h2>
<h3 id="-a-name-discovery-a-node-api-discovery"><a name="discovery"></a> /node/api/discovery</h3>
<h5 id="-a-name-discovery-post-a-post"><a name="discovery.post"></a> POST</h5>
<p>Отправляет discovery-информацию в систему. В теле должен содержаться JSON-документ следующего формата:</p>
<pre><code>{
  "discoveryId": "&lt;внешний идентификатор объекта&gt;",
  "resourceType": "&lt;тип ресурса (разновидность объекта)&gt;",
  "resourceData": { &lt;данные по объекту&gt; }
}
</code></pre><p>, где</p>
<ul>
<li><code>discoveryId</code> - идентификатор, по которому система различает данные по разным объектам (выбирается отправляющей
стороной);</li>
<li><code>resourceType</code> - строка, по которой система определяет разновидность передаваемых данных и
алгоритм их разбора;</li>
<li><code>resourceData</code> - объект с данными.</li>
</ul>
<p>Метод возвращает идентификатор объекта, созданного по переданным данным, либо существующего объекта, если
он был найден для переданного <code>discoveryId</code>.</p>
<p>Пример запроса:</p>
<pre><code>POST /node/api/discovery

{
  "discoveryId": "AABBCCDDEEFF",
  "resourceType": "MEGABOX",
  "resourceData": {
    "name": "Mbox1",
    "mac": "AABBCCDDEEFF",
    "imsi": "123456789098765",
    "imei": "123456789098765",
    "devices": [
      {
        "name": "camera 1",
        "ip": "192.168.100.101",
        "type": "camera",
        "rtsp": "/rtsp?heyheymotherfucker=0&amp;jpg"
      },
      {
        "name": "camera 2",
        "ip": "192.168.100.102",
        "type": "camera",
        "rtsp": "/rtsp?heyheymotherfucker=0&amp;jpg"
      },
      {
        "name": "motion",
        "pin": "3",
        "type": "sensor",
        "alarm_level": "high"
      },
      {
        "name": "door 1",
        "pin": "2",
        "type": "sensor",
        "alarm_level": "high"
      },
      {
        "name": "door 2",
        "pin": "1",
        "type": "sensor",
        "alarm_level": "high"
      },
      {
        "name": "power",
        "pin": "9",
        "type": "sensor",
        "alarm_level": "low"
      },
      {
        "name": "tamper",
        "pin": "10",
        "type": "sensor",
        "alarm_level": "normal"
      }
    ]
  }
}
</code></pre><p>Пример ответа:</p>
<pre><code>5714cb4a8bb3bcbe460b56fb
</code></pre>

</body></html>